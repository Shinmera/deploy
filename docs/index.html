<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Deploy</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project >section img{max-width:100%;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.project #system #author label{vertical-align:top;}article.project #system #author ul{display:inline-block;margin:0;padding:0;list-style:none;}article.project #toc nav>*{margin-left:1em;display:block;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}@media (min-width: 1300px){html body{padding-left:16em;}article.project #toc{margin:0;position:fixed;left:0;top:0;bottom:0;width:15em;overflow-y:auto;background:#F0F0F0;border-right:1px solid #A0A0A0;}}</style> </head> <body> <article class="project"> <header>   <h1>deploy</h1>   <span class="version">2.0.0</span>    <p class="description">Tools to aid in the deployment of a fully standalone application.</p>   </header> <section id="toc"> <h2>Table of Contents</h2> <nav> <a href="#project">Top</a>  <a href="#documentation">Documentation</a> <nav> <a href="#about_deploy">About Deploy</a>  <a href="#how_to">How To</a>  <a href="#customising_foreign_libraries">Customising Foreign Libraries</a>  <a href="#extending_deployment_and_boot_behaviour">Extending Deployment and Boot Behaviour</a>  <a href="#deploying_to_an_os_x_app_bundle">Deploying to an OS X App Bundle</a>  <a href="#debugging_a_deployed_executable">Debugging a Deployed Executable</a>  <a href="#support">Support</a> </nav>  <a href="#system">System</a>  <a href="#system">Packages</a> <nav> <a href="#PACKAGE%20DEPLOY">DEPLOY</a> </nav>  </nav> </section>  <section id="documentation"><h2 id="about_deploy">About Deploy</h2> <p>This is a system to help you easily and quickly deploy standalone common lisp applications as binaries. Specifically it is geared towards applications with foreign library dependencies that run some kind of GUI.</p> <h2 id="how_to">How To</h2> <p>In order to make use of Deploy, you'll have to change the ASDF system definition of your project to contain the following properties:</p> <pre><code>:defsystem-depends-on (:deploy)
:build-operation &quot;deploy-op&quot;
:build-pathname &quot;my-application-name&quot;
:entry-point &quot;my-package:my-start-function&quot;
</code></pre> <p>Once you have updated your system appropriately, all you need to do is start a fresh instance of your implementation from a terminal and run the following function:</p> <pre><code>(asdf:make :my-system)
</code></pre> <p>This will build your system, gather the necessary information, and deploy a standalone <code>bin</code> folder within your project's root directory. You can then ship this folder to your users.</p> <p>If you want to deploy a console application rather than a GUI application, you should use <code><a href="#CLASS%20DEPLOY%3ADEPLOY-CONSOLE-OP" class="xref">deploy-console-op</a></code> instead, which will activate the proper mode on Windows, and suppress the standard startup output.</p> <p>You can also leverage deploy to &quot;just&quot; dump an image of your implementation state rather than a standalone executable. In that case, you should use the <code><a href="#CLASS%20DEPLOY%3ADEPLOY-IMAGE-OP" class="xref">deploy-image-op</a></code>.</p> <p>With SBCL you can even leverage Deploy to create &quot;shrinkwrapped&quot; executables. These executables can statically or dynamically link C libraries and let Lisp stack frames integrate properly with foreign debuggers and profiling tools like perf. To produce a shrinkwrapped executable you must have the SBCL source tree available with which you already built your SBCL. Then you can create your executable by loading deploy and running</p> <pre><code>(<a href="#FUNCTION%20DEPLOY%3ASHRINKWRAP" class="xref">deploy:shrinkwrap</a> &quot;my-system&quot;)
</code></pre> <p>It'll automatically invoke itself again to run <code><a href="#CLASS%20DEPLOY%3ADEPLOY-IMAGE-OP" class="xref">deploy-image-op</a></code> on your system, shrinkwrap that, and then compile it together with the rest of the dynamic libraries it depends on into the final executable.</p> <h2 id="customising_foreign_libraries">Customising Foreign Libraries</h2> <p>Sometimes you might want to designate a specific library for deployment, rather than the one used during development. If this is the case, you have to help Deploy out a little by defining extra information about the library with <code><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">define-library</a></code>. If the foreign library is in the source tree of a lisp library, you can simply associate the CFFI library with the system that provides it, and Deploy will find it automatically:</p> <pre><code><a href="http://l1sp.org/cl/change-class" class="xref">(</a><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">deploy:define-library</a> cffi-library-symbol
  :system :system-name-that-defines-the-library)
</code></pre> <p>For example, the <a href="https://github.com/Shirakumo/cl-mpg123">cl-mpg123</a> system provides a single library, which we would annotate like this:</p> <pre><code><a href="http://l1sp.org/cl/change-class" class="xref">(</a><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">deploy:define-library</a> cl-mpg123-cffi:libmpg123
  :system :cl-mpg123)
</code></pre> <p>If the file is not contained in the directory of the system that provides it, you can also designate specific source directories to scan:</p> <pre><code><a href="http://l1sp.org/cl/change-class" class="xref">(</a><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">deploy:define-library</a> cffi-library-symbol
  :sources '(&quot;/some/path/where/the/library/is/stored/&quot;)) 
</code></pre> <p>Finally, you can also specify the path directly if you want Deploy to choose a particular file, rather than trying to find one on its own:</p> <pre><code><a href="http://l1sp.org/cl/change-class" class="xref">(</a><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">deploy:define-library</a> cffi-library-symbol
  :path &quot;/some/path/to/the/file.so&quot;)
</code></pre> <p>Generally though these extra associations should not be necessary as Deploy will simply take the path that CFFI has already figured out to find the library.</p> <p>Sometimes it might not be desired to deploy all the libraries, or reload them all upon boot. You can change this behaviour with <code><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY" class="xref">define-library</a></code>'s <code>:dont-deploy</code> and <code>:dont-open</code> properties respectively.</p> <h2 id="extending_deployment_and_boot_behaviour">Extending Deployment and Boot Behaviour</h2> <p>Deploy also offers a hooks system with which you can easily extend the steps performed during deployment and during the boot process of the generated executable. With the <code><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-HOOK" class="xref">define-hook</a></code> macro you can add functions that are executed during various points of the process. Specifically, the following types are available:</p> <ul> <li><code>:deploy</code> These functions are responsible for copying files into the deployment target directory.</li> <li><code>:build</code> These functions should prepare the system for the dump to binary. Specifically you might want to shut down existing threads, close file handles, remove unneeded baggage, and remove potentially sensitive information about your system.</li> <li><code>:boot</code> These functions are run right before the primary entry point is executed. Thus they are responsible for preparing the runtime to continue by restarting threads, re-opening files, and so forth.</li> <li><code>:quit</code> These functions are run right before the executable exits completely. They offer a last-minute opportunity to dump some information about the system, or to clean up vital resources.</li> </ul> <p>If you would simply like to include a data directory to bundle with the rest, use <code><a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-RESOURCE-DIRECTORY" class="xref">define-resource-directory</a></code>. After boot, all of the resource files will be in the directory returned by <code><a href="#FUNCTION%20DEPLOY%3ADATA-DIRECTORY" class="xref">data-directory</a></code>.</p> <h2 id="deploying_to_an_os_x_app_bundle">Deploying to an OS X App Bundle</h2> <p>If you would like a nicely bundled <code>.app</code> for OS X, you can simply change the <code>build-operation</code> in your ASDF system file to <code><a href="#CLASS%20DEPLOY%3AOSX-APP-DEPLOY-OP" class="xref">osx-app-deploy-op</a></code>. If you would like to customise the <code>Info.plist</code> file that is generated for the app, you can change <code><a href="#VARIABLE%20DEPLOY%3A%2AINFO-PLIST-TEMPLATE%2A" class="xref">*info-plist-template*</a></code> to point to a file that contains what you want.</p> <h2 id="debugging_a_deployed_executable">Debugging a Deployed Executable</h2> <p>If you're having trouble with an application that's already deployed, there's a few things you can do to debug it by setting environment variables. The following are recognised by Deploy:</p> <ul> <li><code>DEPLOY_DEBUG_BOOT</code> if set to a non-empty value, on error the debugger is invoked rather than just exiting the application.</li> <li><code>DEPLOY_REDIRECT_OUTPUT</code> if set to a file path, the output of all streams is redirected to this file.</li> </ul> <p>Particularly on Windows and OS X debugging can be an issue, as a GUI application will not get a standard output to write to. In that case, the above redirect might help.</p> <h2 id="support">Support</h2> <p>If you'd like to support the continued development of Deploy, please consider becoming a backer on Patreon:</p> <p><a href="https://patreon.com/shinmera"> <img alt="Patreon" src="https://filebox.tymoon.eu//file/TWpjeU9RPT0="> </a></p> </section>    <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">2.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external">cffi</a></li><li><a class="external">sha3</a></li><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li><li><a class="external">trivial-features</a></li></ul> </div>   <div class="row" id="author"> <label for="author">Author:</label> <a href="mailto:shinmera@tymoon.eu">Yukari Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shinmera.github.io/deploy/">https://Shinmera.github.io/deploy/</a> </div>   <div class="row"> <label for="bug-tracker">Bug Tracker:</label> <a id="bug-tracker" href="https://github.com/Shinmera/deploy/issues">https://github.com/Shinmera/deploy/issues</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/Shinmera/deploy.git">https://github.com/Shinmera/deploy.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE DEPLOY"> <header> <h3> <a href="#PACKAGE%20DEPLOY">DEPLOY</a> </h3> <ul class="nicknames"> <li>ORG.SHIRAKUMO.DEPLOY</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*COMPRESSION-FACTOR*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ACOMPRESSION-FACTOR%2A">*COMPRESSION-FACTOR*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L4">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*DATA-LOCATION*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ADATA-LOCATION%2A">*DATA-LOCATION*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L3">Source</a>  </header> <div class="docstring"><pre>Relative path designating the location of the resource directory.

This path should be relative to the location of
the executable.

You may set this variable before deployment to
influence where resource files are stored.

See <a href="#FUNCTION%20DEPLOY%3ADATA-DIRECTORY" class="xref">DATA-DIRECTORY</a></pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*INFO-PLIST-TEMPLATE*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2AINFO-PLIST-TEMPLATE%2A">*INFO-PLIST-TEMPLATE*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/osx.lisp#L3">Source</a>  </header> <div class="docstring"><pre>This variable holds a pathname pointing to the Info.plist template to use for OS X app bundles.

See <a href="#FUNCTION%20DEPLOY%3APARSE-INFO-PLIST" class="xref">PARSE-INFO-PLIST</a></pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*SBCL-SOURCE-TREE*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ASBCL-SOURCE-TREE%2A">*SBCL-SOURCE-TREE*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/shrinkwrap.lisp#L3">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*SOURCE-CHECKSUM*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ASOURCE-CHECKSUM%2A">*SOURCE-CHECKSUM*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/checksum.lisp#L3">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*STATUS-OUTPUT*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ASTATUS-OUTPUT%2A">*STATUS-OUTPUT*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L4">Source</a>  </header> <div class="docstring"><pre>The output stream of status messages.

You can set this to NIL if you want to suppress status
messages on the console, or set them to some other
stream that won't bother the user.

See <a href="#FUNCTION%20DEPLOY%3ASTATUS" class="xref">STATUS</a></pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE DEPLOY:*SYSTEM-SOURCE-DIRECTORIES*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20DEPLOY%3A%2ASYSTEM-SOURCE-DIRECTORIES%2A">*SYSTEM-SOURCE-DIRECTORIES*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/library.lisp#L3">Source</a>  </header> <div class="docstring"><pre>This variable holds a list of paths to system library directories.

Deploy will search through these paths to attempt to
find the source of libraries if the more explicitly
provided paths should fail.</pre></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:DEPLOY-CONSOLE-OP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3ADEPLOY-CONSOLE-OP">DEPLOY-CONSOLE-OP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L267">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:DEPLOY-IMAGE-OP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3ADEPLOY-IMAGE-OP">DEPLOY-IMAGE-OP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L273">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:DEPLOY-OP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3ADEPLOY-OP">DEPLOY-OP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L202">Source</a>  </header> <div class="docstring"><pre>An ASDF operation to perform a deployment.

When this operation is performed, the following steps
are taken:

1. The :LOAD hooks are run with the appropriate
   arguments.
2. The output files are determined, which should be
   a list of two paths, the first being the executable
   to dump to, and the second being a directory where
   all the resources should be stored.
3. The list of libraries to reload on boot is computed
   by removing all libraries that are either marked as
   dont-open, or aren't yet opened from LIST-LIBRARIES.
4. The deployment directories are created.
5. The *DATA-LOCATION* path is adapted to be relative
   to the binary file.
6. The :DEPLOY hooks are run with the appropriate
   arguments.
7. The :BUILD hooks are run with the appropriate
   arguments.
8. The image is dumped to an executable format, using
   core compression if available, and using the
   appropriate application type depending on the
   presence of the operating system and the
   :DEPLOY-CONSOLE feature flag.

See <a href="#FUNCTION%20DEPLOY%3ALIST-LIBRARIES" class="xref">LIST-LIBRARIES</a>
See <a href="#VARIABLE%20DEPLOY%3A%2AFOREIGN-LIBRARIES-TO-RELOAD%2A" class="xref">*FOREIGN-LIBRARIES-TO-RELOAD*</a>
See <a href="#VARIABLE%20DEPLOY%3A%2ADATA-LOCATION%2A" class="xref">*DATA-LOCATION*</a>
See <a href="#FUNCTION%20DEPLOY%3AFIND-RELATIVE-PATH-TO" class="xref">FIND-RELATIVE-PATH-TO</a>
See <a href="#FUNCTION%20DEPLOY%3ARUN-HOOKS" class="xref">RUN-HOOKS</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3AHOOK">HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L5">Source</a>  </header> <div class="docstring"><pre>This class encapsulates a hook.

Hooks are functions that are run during various
points of deployment and execution of the resulting
executable.

See <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-NAME" class="xref">HOOK-NAME</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-TYPE" class="xref">HOOK-TYPE</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-FUNCTION" class="xref">HOOK-FUNCTION</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-PRIORITY" class="xref">HOOK-PRIORITY</a>
See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3AREMOVE-HOOK" class="xref">REMOVE-HOOK</a>
See <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-HOOK" class="xref">DEFINE-HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3ARUN-HOOKS" class="xref">RUN-HOOKS</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:LIBRARY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3ALIBRARY">LIBRARY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/library.lisp#L35">Source</a>  </header> <div class="docstring"><pre>Class to represent a foreign library.

This is a subclass of CFFI:FOREIGN-LIBRARY with some
additional slots for information necessary for the
Deploy system.

Upon shared-initialize, if the LIBRARY-PATH is not
explicitly set, it is resolved through FIND-SOURCE-
FILE.

See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SYSTEM" class="xref">LIBRARY-SYSTEM</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SOURCES" class="xref">LIBRARY-SOURCES</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-PATH" class="xref">LIBRARY-PATH</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-OPEN-P" class="xref">LIBRARY-DONT-OPEN-P</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-DEPLOY-P" class="xref">LIBRARY-DONT-DEPLOY-P</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3AFIND-SOURCE-FILE" class="xref">FIND-SOURCE-FILE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:OSX-APP-DEPLOY-OP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3AOSX-APP-DEPLOY-OP">OSX-APP-DEPLOY-OP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/osx.lisp#L10">Source</a>  </header> <div class="docstring"><pre>This deployment op generates an OS X app bundle.

See <a href="#CLASS%20DEPLOY%3ADEPLOY-OP" class="xref">DEPLOY-OP</a>
See <a href="#FUNCTION%20DEPLOY%3APARSE-INFO-PLIST" class="xref">PARSE-INFO-PLIST</a>
See <a href="#VARIABLE%20DEPLOY%3A%2AINFO-PLIST-TEMPLATE%2A" class="xref">*INFO-PLIST-TEMPLATE*</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS DEPLOY:SHRINKWRAP-OP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20DEPLOY%3ASHRINKWRAP-OP">SHRINKWRAP-OP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/shrinkwrap.lisp#L47">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:COPY-DIRECTORY-TREE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ACOPY-DIRECTORY-TREE">COPY-DIRECTORY-TREE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument">TARGET</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">COPY-ROOT</li>    <li class="argument">EXCLUDE</li>    <li class="argument">IF-EXISTS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L94">Source</a>  </header> <div class="docstring"><pre>Copy the source directory to the target directory.

If COPY-ROOT is true, the source folder itself is
copied, otherwise only its contents are copied.

EXCLUDE may be a function of one argument, a source path, which
returns a boolean designating whether the source file should be
excluded or not.

IF-EXISTS may be one of the following values, governing what to do if
the destination file exists already:
  :REPLACE :SUPERSEDE :OVERWRITE
      --- Replaces the file regardless
  NIL :IGNORE
      --- Does nothing
  :ERROR
      --- Signals an error
  :UPDATE
      --- Replaces the file if its write date is older than the source
          file's</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:DATA-DIRECTORY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ADATA-DIRECTORY">DATA-DIRECTORY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L6">Source</a>  </header> <div class="docstring"><pre>Return an absolute path to the resource directory.

See <a href="#FUNCTION%20DEPLOY%3ADATA-DIRECTORY" class="xref">DATA-DIRECTORY</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:DEPLOYED-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ADEPLOYED-P">DEPLOYED-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L6">Source</a>  </header> <div class="docstring"><pre>Returns T if the current Lisp environment has been booted from a deployed executable.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:ENSURE-LIBRARY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AENSURE-LIBRARY">ENSURE-LIBRARY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/library.lisp#L29">Source</a>  </header> <div class="docstring"><pre>Return the corresponding LIBRARY instance, if possible.

The following happens for the following type of
the argument:
- LIBRARY               The argument is returned.
- CFFI:FOREIGN-LIBRARY  The object is CHANGE-CLASSd
                        into a LIBRARY instance.
- SYMBOL                The library instance is
                        retrieved by name and then
                        passed back in.

See CFFI::GET-FOREIGN-LIBRARY
See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:ENV-SET-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AENV-SET-P">ENV-SET-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">ENVVAR</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L64">Source</a>  </header> <div class="docstring"><pre>Returns the value of the given environment variable if it is set to a non-empty value.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AHOOK">HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L20">Source</a>  </header> <div class="docstring"><pre>Accessor to the hook instance of the given type and name.

See <a href="#VARIABLE%20DEPLOY%3A%2AHOOKS%2A" class="xref">*HOOKS*</a>
See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3AREMOVE-HOOK" class="xref">REMOVE-HOOK</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:(SETF HOOK)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3A%28SETF%20HOOK%29">(SETF HOOK)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">HOOK</li>    <li class="argument">TYPE</li>    <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L26">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:LIST-LIBRARIES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ALIST-LIBRARIES">LIST-LIBRARIES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/library.lisp#L24">Source</a>  </header> <div class="docstring"><pre>Return a fresh list of known foreign libraries.

All the returned libraries will be of type LIBRARY.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a>
See CFFI:LIST-FOREIGN-LIBRARIES
See <a href="#FUNCTION%20DEPLOY%3AENSURE-LIBRARY" class="xref">ENSURE-LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:PARSE-INFO-PLIST"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3APARSE-INFO-PLIST">PARSE-INFO-PLIST</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">TEMPLATE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/osx.lisp#L26">Source</a>  </header> <div class="docstring"><pre>Parses the Info.plist file and replaces values as appropriate.

Specifically, anything enclosed in [] is taken as a
list of symbols designating functions to call with
the system object. The resulting values are then
turned into a string by PRINC-TO-STRING, and escaped
for usage by XML-ESCAPED before writing them to
the returned string in place of the []. Note that you
can enclose multiple symbols. The value of the first
function call that returns non-NIL is used as the
value to splice into the file.

This allows to conveniently fill an Info.plist
template with values from the ASDF system.

Have a look at the standard Info.plist file shipped
with Deploy for what's possible.

See <a href="#VARIABLE%20DEPLOY%3A%2AINFO-PLIST-TEMPLATE%2A" class="xref">*INFO-PLIST-TEMPLATE*</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:QUIT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AQUIT">QUIT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">SYSTEM</li>    <li class="argument">OP</li>    <li class="argument">EXIT-CODE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/deploy.lisp#L168">Source</a>  </header> <div class="docstring"><pre>Runs the quit hooks and terminates the application.

If an error occurs during the execution of a quit hook, it
is ignored.

See <a href="#FUNCTION%20DEPLOY%3ARUN-HOOKS" class="xref">RUN-HOOKS</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:REDIRECT-OUTPUT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AREDIRECT-OUTPUT">REDIRECT-OUTPUT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TARGET</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L69">Source</a>  </header> <div class="docstring"><pre>Redirect all output to the given file.

This changes *STANDARD-OUTPUT*, *ERROR-OUTPUT*,
*TRACE-OUTPUT*, and *DEBUG-IO*. For the latter,
only its output stream is changed.

The stream to the given target file is returned.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:REMOVE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3AREMOVE-HOOK">REMOVE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L31">Source</a>  </header> <div class="docstring"><pre>Remove the hook of the given type and name.

See <a href="#VARIABLE%20DEPLOY%3A%2AHOOKS%2A" class="xref">*HOOKS*</a>
See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:RUN-HOOKS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ARUN-HOOKS">RUN-HOOKS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L49">Source</a>  </header> <div class="docstring"><pre>Run the hooks of the given type, supplying the given arguments.

Refer to DEFINE-HOOKS for the recognised arguments for
each hook type.

This function simply iterates through *HOOKS*, checks the
HOOK-TYPE for compliance, establishes a REPORT-ERROR
restart, and then applies the HOOK-FUNCTION to the given
arguments.

The REPORT-ERROR restart simply prints out the error it
receives and is thus useful for ignoring errors that
might occur during the execution of a hook.

See <a href="#VARIABLE%20DEPLOY%3A%2AHOOKS%2A" class="xref">*HOOKS*</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-FUNCTION" class="xref">HOOK-FUNCTION</a>
See <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-HOOK" class="xref">DEFINE-HOOK</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:RUNTIME-DIRECTORY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ARUNTIME-DIRECTORY">RUNTIME-DIRECTORY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L83">Source</a>  </header> <div class="docstring"><pre>Returns a pathname to the directory where the executable is being run in.

See UIOP:ARGV0</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:SHRINKWRAP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ASHRINKWRAP">SHRINKWRAP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument lambda-list-keyword">&amp;ALLOW-OTHER-KEYS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/shrinkwrap.lisp#L98">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:SOURCE-CHECKSUM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ASOURCE-CHECKSUM">SOURCE-CHECKSUM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/checksum.lisp#L29">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION DEPLOY:STATUS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20DEPLOY%3ASTATUS">STATUS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LEVEL</li>    <li class="argument">FORMAT-STRING</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">FORMAT-ARGS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/toolkit.lisp#L55">Source</a>  </header> <div class="docstring"><pre>Print a status message to *status-output*.

The level determines the granularity of the message.
Higher levels mean &quot;more detailed&quot;.

See <a href="#VARIABLE%20DEPLOY%3A%2ASTATUS-OUTPUT%2A" class="xref">*STATUS-OUTPUT*</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:CLOSE-LIBRARY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ACLOSE-LIBRARY">CLOSE-LIBRARY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Close/unload the library.

See CFFI:CLOSE-FOREIGN-LIBRARY</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:DISCOVER-ENTRY-POINT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ADISCOVER-ENTRY-POINT">DISCOVER-ENTRY-POINT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OP</li>    <li class="argument">C</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Attempt to resolve the given ASDF system's entry point to a function.

The entry point may be either a function or a class
designator. If a class, returned is a function that
simply instantiates the class.

See ASDF/SYSTEM:COMPONENT-ENTRY-POINT</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:FIND-SOURCE-FILE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AFIND-SOURCE-FILE">FIND-SOURCE-FILE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Attempt to find the source file of the library on the system.

Uses the directories listed in POSSIBLE-DIRECTORIES
to look for the library source.

The directories are searched for pathnames that
match one of the POSSIBLE-PATHNAMES for the library.

See <a href="#GENERIC-FUNCTION%20DEPLOY%3APOSSIBLE-DIRECTORIES" class="xref">POSSIBLE-DIRECTORIES</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3APOSSIBLE-PATHNAMES" class="xref">POSSIBLE-PATHNAMES</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:HOOK-FUNCTION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-FUNCTION">HOOK-FUNCTION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the function of the hook.

This function is what is executed when RUN-HOOKS
is called.

See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3ARUN-HOOKS" class="xref">RUN-HOOKS</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF HOOK-FUNCTION)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20HOOK-FUNCTION%29">(SETF HOOK-FUNCTION)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:HOOK-NAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-NAME">HOOK-NAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the name of the hook.

The name should be a symbol.

See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF HOOK-NAME)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20HOOK-NAME%29">(SETF HOOK-NAME)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:HOOK-PRIORITY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-PRIORITY">HOOK-PRIORITY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the priority of the hook.

The priority should be an integer.
The higher the priority, the earlier the hook is
executed.

See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF HOOK-PRIORITY)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20HOOK-PRIORITY%29">(SETF HOOK-PRIORITY)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:HOOK-TYPE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AHOOK-TYPE">HOOK-TYPE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the type of the hook.

The type can be one of :LOAD :BUILD :DEPLOY :BOOT :QUIT.

See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF HOOK-TYPE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20HOOK-TYPE%29">(SETF HOOK-TYPE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-DONT-DEPLOY-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-DEPLOY-P">LIBRARY-DONT-DEPLOY-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to whether to deploy (copy) the library to the resources directory on build.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF LIBRARY-DONT-DEPLOY-P)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20LIBRARY-DONT-DEPLOY-P%29">(SETF LIBRARY-DONT-DEPLOY-P)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-DONT-OPEN-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-OPEN-P">LIBRARY-DONT-OPEN-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to whether the library should not be opened on boot.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF LIBRARY-DONT-OPEN-P)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20LIBRARY-DONT-OPEN-P%29">(SETF LIBRARY-DONT-OPEN-P)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-NAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-NAME">LIBRARY-NAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Return the library's name.

See CFFI:FOREIGN-LIBRARY-NAME</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-OPEN-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-OPEN-P">LIBRARY-OPEN-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Returns whether the library is currently open.

See CFFI:FOREIGN-LIBRARY-LOADED-P</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-PATH"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-PATH">LIBRARY-PATH</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the definite path to the library's source file.

If this is NIL, the library could not be found.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF LIBRARY-PATH)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20LIBRARY-PATH%29">(SETF LIBRARY-PATH)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-SOURCES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SOURCES">LIBRARY-SOURCES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the list of additional paths to search for source files.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF LIBRARY-SOURCES)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20LIBRARY-SOURCES%29">(SETF LIBRARY-SOURCES)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:LIBRARY-SYSTEM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SYSTEM">LIBRARY-SYSTEM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the ASDF system associated with the library.

If there is a system associated with this library,
the system's source tree is used to search for the
library's source file.

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:(SETF LIBRARY-SYSTEM)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3A%28SETF%20LIBRARY-SYSTEM%29">(SETF LIBRARY-SYSTEM)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:OPEN-LIBRARY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3AOPEN-LIBRARY">OPEN-LIBRARY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Open/load the library.

See CFFI:LOAD-FOREIGN-LIBRARY</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:POSSIBLE-DIRECTORIES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3APOSSIBLE-DIRECTORIES">POSSIBLE-DIRECTORIES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Return a list of possible directories to search for the library.

By default this list includes:
- The LIBRARY-SOURCES of the library.
- The directory tree of the LIBRARY-SYSTEM's source.
- The CFFI:*FOREIGN-LIBRARY-DIRECTORIES*
- The *SYSTEM-SOURCE-DIRECTORIES*
- The paths from the following environment variables:
  - PATH on Windows
  - LD_LIBRARY_PATH on Linux
  - DYLD_LIBRARY_PATH on Darwin

See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SOURCES" class="xref">LIBRARY-SOURCES</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SYSTEM" class="xref">LIBRARY-SYSTEM</a>
See <a href="#FUNCTION%20DEPLOY%3ADISCOVER-SUBDIRECTORIES" class="xref">DISCOVER-SUBDIRECTORIES</a>
See CFFI:*FOREIGN-LIBRARY-DIRECTORIES*
See <a href="#VARIABLE%20DEPLOY%3A%2ASYSTEM-SOURCE-DIRECTORIES%2A" class="xref">*SYSTEM-SOURCE-DIRECTORIES*</a>
See <a href="#FUNCTION%20DEPLOY%3AENV-PATHS" class="xref">ENV-PATHS</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION DEPLOY:POSSIBLE-PATHNAMES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20DEPLOY%3APOSSIBLE-PATHNAMES">POSSIBLE-PATHNAMES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LIBRARY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Return a list of possible file pathnames that match the library.

By default this list includes:
- The CFFI:FOREIGN-LIBRARY-PATHNAME if present.
- Paths computed through the CFFI library's spec.
- A generic path after the LIBRARY-NAME.

See CFFI:FOREIGN-LIBRARY-PATHNAME
See CFFI:DEFINE-FOREIGN-LIBRARY
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-NAME" class="xref">LIBRARY-NAME</a>
See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a>
See <a href="#FUNCTION%20DEPLOY%3ARESOLVE-CFFI-SPEC" class="xref">RESOLVE-CFFI-SPEC</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION DEPLOY:DEFINE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-HOOK">DEFINE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">TYPE</li>  <li class="argument">NAME</li>  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">PRIORITY</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L37">Source</a>  </header> <div class="docstring"><pre>Define a new hook function.

The args list's arguments are automatically turned into
keyword arguments for the hook function. This allows you
to only specify the arguments that you are interested in.

The following arguments are available for all hook types:
- SYSTEM  The ASDF system object the application is built
          with.
- OP      The ASDF operation object used to build the
          application.

The following hook types are recognised:
- :load    These functions should perform the loading of
           systems or other kinds of things that will
           potentially change the set of libraries.

- :deploy  These functions are responsible for copying
           files into the deployment target directory.
           It supplies the following extra arguments:
  - DIRECTORY  The target directory into which resource
               files should be placed.

- :build   These functions should prepare the system for
           the dump to binary. Specifically you might
           want to shut down existing threads, close file
           handles, remove unneeded baggage, and remove
           potentially sensitive information about your
           system.

- :boot    These functions are run right before the
           primary entry point is executed. Thus they are
           responsible for preparing the runtime to
           continue by restarting threads, re-opening
           files, and so forth.
           It supplies the following extra arguments:
  - DIRECTORY  The directory in which the resource files
               now reside after boot.

- :quit    These functions are run right before the
           executable exits completely. They offer a
           last-minute opportunity to dump some
           information about the system, or to clean up
           vital resources.

See <a href="#FUNCTION%20DEPLOY%3AHOOK" class="xref">HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3AREMOVE-HOOK" class="xref">REMOVE-HOOK</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION DEPLOY:DEFINE-LIBRARY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-LIBRARY">DEFINE-LIBRARY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">INITARGS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/library.lisp#L158">Source</a>  </header> <div class="docstring"><pre>Define additional properties for a foreign library.

The NAME should be one of a valid CFFI foreign
library as defined by CFFI:DEFINE-FOREIGN-LIBRARY.

Valid properties are:
- :SYSTEM
- :SOURCES
- :PATH    
- :DONT-OPEN  
- :DONT-DEPLOY

See <a href="#CLASS%20DEPLOY%3ALIBRARY" class="xref">LIBRARY</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SYSTEM" class="xref">LIBRARY-SYSTEM</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-SOURCES" class="xref">LIBRARY-SOURCES</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-PATH" class="xref">LIBRARY-PATH</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-OPEN-P" class="xref">LIBRARY-DONT-OPEN-P</a>
See <a href="#GENERIC-FUNCTION%20DEPLOY%3ALIBRARY-DONT-DEPLOY-P" class="xref">LIBRARY-DONT-DEPLOY-P</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION DEPLOY:DEFINE-RESOURCE-DIRECTORY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-RESOURCE-DIRECTORY">DEFINE-RESOURCE-DIRECTORY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <li class="argument">DIRECTORY</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">COPY-ROOT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/deploy/blob/78604cc72c2f5dcf52b6eb0a691e0522db7db671/hooks.lisp#L57">Source</a>  </header> <div class="docstring"><pre>Shorthand to define a hook that simply deploys the given directory.

The directory has to be a form that evaluates to a
pathname to a directory that should be copied. The
path is merged with the system source directory of
the system being deployed. This means that relative
paths are relative to the source root of your system.

See <a href="#MACRO-FUNCTION%20DEPLOY%3ADEFINE-HOOK" class="xref">DEFINE-HOOK</a>
See <a href="#FUNCTION%20DEPLOY%3ACOPY-DIRECTORY-TREE" class="xref">COPY-DIRECTORY-TREE</a></pre></div> </article> </li> </ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 